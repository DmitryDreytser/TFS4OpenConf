<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN">
<html>
<head>
<meta name="generator" content=
"HTML Tidy for Windows (vers 1st March 2004), see www.w3.org">
<meta content="text/html; charset=windows-1251" http-equiv=
"content-type">
<title>Moxcel (версия 1.11 бета от 25.03.2004)</title>
<meta content="Формат Moxcel" name="description">
</head>
<body>
<h1>Moxcel (версия 1.11 бета от 25.03.2004)</h1>
Данный документ доступент по следующим адрессам:<br>
<a href=
"http://sourceforge.net/projects/lproject">http://sourceforge.net/projects/lproject</a><br>

<a href="http://1l.w4b.ru/">http://1l.w4b.ru/</a><br>
Авторство принадлежит:<br>
Copyright © 2004 Дмитрий Павлюк &lt;dmp@myrealbox.com&gt;<br>
Copyright © 2004 Евгений Пивнев &lt;eugene@spb.rosgazservice.com&gt;<br>
<p>Каждый имеет право воспроизводить, распространять и/или вносить
изменения в настоящий документ в соответствии с условиями GNU Free
Documentation License, версией 1.2 или любой более поздней версией,
опубликованной Free Software Foundation;</p>
<p>Данный документ не содержит неизменяемых разделов, текста,
помещаемого на первой странице обложки, и текста, помещаемого на
последней странице обложки.</p>
<p>Копия GNU Free Documentation License помещена в файл под
названием " <a href=
"file:///C:/1L/wx1L/temp/docs/GNU_FDL.html">GNU_FDL.html</a>".</p>
<h2><a id="Contents" name="Contents"></a>Содержание</h2>
<a href="#Thanks">Благодарности</a><br>
<a href="#Enter">1. Введение</a><br>
<a href="#struct">2. Структура файла</a><br>
<a href="#begin">3. Заголовок файла</a><br>
<a href="#PropSel">4. Свойства ячеек (общие)</a><br>
<blockquote><a href="#PropSelByGr">4.1. Свойства ячеек по группам
(вкладкам)</a><br>
<a href="#r1">4.2. Рисунки цвета</a><br>
<a href="#r2">4.3. Рисунки узора</a><br>
<a href="#r3">4.4. Рисунки стилей рамки</a><br>
<a href="#PropT">4.5. Свойства таблицы (отличия)</a><br>
<a href="#PropPH">4.6. Свойства колонтитулов (отличия)</a><br>
<a href="#PropCol">4.7. Свойства ячейки для колонок
(отличия)</a><br>
<a href="#PropRow">4.8. Свойства ячейки для строк (отличия)</a><br>
<a href="#Obj1">4.9. Свойства ячейки для рисунков</a><br>
<a href="#ObjGlb">4.10. Свойства рисунка - дополнение к св-вам
ячейки</a></blockquote>
<blockquote>
<blockquote><a href="#Obj2">+Рисунок</a><br>
<a href="#Obj3">+OLE</a></blockquote>
<a href="#dialog">4.11. Свойства ячейки для диалога
(формы)</a></blockquote>
<a href="#PropFont">5. Свойства шрифта</a><br>
<a href="#Merge">6. Свойства объединения</a><br>
<a href="#Sect">7. Свойства секции</a><br>
<a href="#Name">8. Свойства имен</a><br>
<hr>
<h2><a id="Thanks" name="Thanks"></a>Благодарности</h2>
Большое спасибо:<br>
<b>Дмитрию Серёжину &lt;dm88@bk.ru&gt;</b>, ICQ - 36513822 -
начавшему разбор формата, и предоставивший, начальные данные по
формату (*.mxl).<br>
<b>Евгению Пивневу &lt;eugene@spb.rosgazservice.com&gt;</b> -
активно учавствовавшему в разборе формата (*.mxl), и его
тестировании.
<hr>
<h2><a id="Enter" name="Enter"></a>Введение/Комментарии</h2>
<ol>
<li>Файлы типа *.mxl или "moxсel" представляют собой набор
последовательных блоков. Т.е. при разборе файла всегда известна
структура текущего блока и какой следующий блок, после текущего.
Размер блока может увеличиваться в зависимости от содержимого
блока, т.к. может содержать вложенные блоки.</li>
<li>Что такое блок? В принципе их два типа  - "логический" и
"физический". Логический блок - это собрание физических блоков в
логически целый объект, а физический - это данные, длина которых
всегда известна и не меняется. :)</li>
<li>Как правило физический блок устроен так:
<ul>
<li>"количество данных" - число которое указывает, сколько порций
данных будет далее;</li>
<li>"данные" - данные заданной длины или блоки известной структуры,
которые идут друг за другом.</li>
</ul>
Т. е.  длина блока не постоянна, а зависит от количества данных
которые в нее входят, и если в нее входят другие блоки, то и от их
длины.</li>
<li>Логический блок чаще всего устроен так:
<ul>
<li>блок номеров</li>
<li>блок свойств</li>
</ul>
Например:<br>
блок номеров - [кол-во номеров] [номер 1] [номер 2] ... [номер
n]<br>
блок свойств - [кол-во св-в] [св-во 1] [св-во 2] ... [св-во m]<br>
(!) Важно, как правило n = m, т.к. если сначала идут номера
свойств, то их и должно быть столько же, сколько и свойств,
справедливо и обратное. :-)<br>
И пример их физической реализации:<br>
<table border="1" cellspacing="2" cellpadding="2">
<tbody>
<tr>
<td>данные</td>
<td>длина</td>
<td>комментарий</td>
</tr>
<tr>
<td>0x0003</td>
<td>2</td>
<td>кол-во номеров = 3</td>
</tr>
<tr>
<td>0x00000001</td>
<td>4</td>
<td>первое св-во имеет номер = 1</td>
</tr>
<tr>
<td>0x00000005</td>
<td>4</td>
<td>второе св-во имеет номер = 5</td>
</tr>
<tr>
<td>0x00000006</td>
<td>4</td>
<td>и т.д.</td>
</tr>
<tr>
<td>0x0003</td>
<td>2</td>
<td>кол-во св-в = 3</td>
</tr>
<tr>
<td>0x000000000066</td>
<td>6</td>
<td>св-во № 1</td>
</tr>
<tr>
<td>0x000000005500</td>
<td>6</td>
<td>св-во № 5</td>
</tr>
<tr>
<td>0x007700005500</td>
<td>6</td>
<td>и т.п.</td>
</tr>
</tbody>
</table>
</li>
<li>Наиболее распространенным блоком являются св-ва ячейки. Его
формат с небольшими изменениями используется для следующих
св-в:<br>
<ul>
<li>общие св-ва таблицы;</li>
<li>св-ва колонтитулов;</li>
<li>св-ва колонок;</li>
<li>св-ва строк;</li>
<li>св-ва ячейки; :)</li>
<li>св-ва рисунка (OLE, диаграммы);</li>
<li>св-ва ячеки диалоговой таблицы.<br></li>
</ul>
</li>
<li>Что такое диалоговая таблица?<br>
"Диалоговая таблица" - это таблица которая работает в режиме ввода
данных. Т.е. это естественно или в отчете, или в обработке в
"св-вах формы" выбрана таблица "для ввода данных". После чего в
св-вах ячейки появляется дополнительная вкладка "Данные".</li>
<li>Свойства ячейки всегда состоят и пары значений флажок и
значение. Если значение флажка не ноль, то сопутствующее ему
значение установленно и имеет смысл, Если флажок не установлен, то
сопутствующее ему значение либо ноль, либо сохраняет прошлое
значение. Флажки являются битовыми. т. е. в одном байте - 8 бит - 8
флажков.<br>
В таблице <a href="#PropSelByGr">"свойств ячеек по группам"</a>
отображены вышеупомянутые пары.</li>
<li>Некоторые выводы:<br>
<ul>
<li>Весь файл можно прочитать только зная всю структуру файла, т.е.
расшифровку всех блоков.</li>
<li>В файл записываются только изменненые значения.</li>
</ul>
</li>
<li>То что не сохраняется в таблице:<br>
<ul>
<li>"Область печати"</li>
<li>"Повторять на каждом листе"</li>
<li>"Параметры страницы"</li>
</ul>
</li>
<li>Что необходимо еще сделать:<br>
<ul>
<li>Много непонятных значений в рисунках и OLE.</li>
<li>Рисунки к св-вам рисунков</li>
<li>...<br></li>
</ul>
</li>
</ol>
<br>
<hr width="100%" size="2">
<h2><a id="struct" name="struct"></a>Структура файла</h2>
Краткое описание колонок:<br>
3 - Обязательная длина, которая есть всегда.<br>
4,5 - Длина первого, второго уровня, есть только тогда, когда в
вышестоящем уровне указано длина больше нуля, и повторяется столько
раз, сколько указано в длине.<br>
Если в длине указан "+" значит длина зарание неизвестна, нужно
смотреть свойства текущего блока.<br>
<table border="1" cellspacing="2" cellpadding="2">
<tbody>
<tr>
<td><b>1<br></b></td>
<td><b>2<br></b></td>
<td width="50"><b>3<br></b></td>
<td width="50"><b>4<br></b></td>
<td width="50"><b>5<br></b></td>
<td><b>6<br></b></td>
</tr>
<tr>
<td><b>логические<br>
блоки<br></b></td>
<td><b>физические<br>
блоки<br></b></td>
<td width="50"><b>дл.<br>
обяз.<br></b></td>
<td width="50"><b>дл.<br>
ур. 1<br></b></td>
<td width="50"><b>дл.<br>
ур. 2<br></b></td>
<td><b>комментарии</b><br></td>
</tr>
<tr>
<td><b>заголовок</b></td>
<td><br></td>
<td>25<br>
(0x19)<br></td>
<td><br></td>
<td><br></td>
<td><a href="#begin">заголовок</a><br></td>
</tr>
<tr>
<td><b>таблица</b></td>
<td>св-ва ячейки для все таблицы</td>
<td>30<br></td>
<td><br></td>
<td><br></td>
<td><a href="#PropT">св-ва ячейки для табл.</a><br></td>
</tr>
<tr>
<td><b>шрифты</b></td>
<td>номера шрифтов</td>
<td>2<br></td>
<td><br></td>
<td><br></td>
<td>кол-во<br></td>
</tr>
<tr>
<td><b><br></b></td>
<td><br></td>
<td><br></td>
<td>4<br></td>
<td><br></td>
<td>номер шрифта<br></td>
</tr>
<tr>
<td><br></td>
<td>шрифты</td>
<td>2<br></td>
<td><br></td>
<td><br></td>
<td>кол-во = предедущ.<br></td>
</tr>
<tr>
<td><b><br></b></td>
<td><br></td>
<td><br></td>
<td>60</td>
<td><br></td>
<td><a href="#PropFont">св-ва шрифта</a><br></td>
</tr>
<tr>
<td><b><br></b></td>
<td>(?)</td>
<td>4<br></td>
<td><br></td>
<td><br></td>
<td>(?)</td>
</tr>
<tr>
<td><b>колонтитулы</b></td>
<td>верхний колонтитул</td>
<td>30<br></td>
<td><br></td>
<td><br></td>
<td><a href="#PropPH">св-ва ячейки для колонт.</a><br></td>
</tr>
<tr>
<td><br></td>
<td>нижний колонтитул</td>
<td>30<br></td>
<td><br></td>
<td><br></td>
<td><a href="#PropPH">св-ва ячейки для колонт.</a><br></td>
</tr>
<tr>
<td><b>колонки</b></td>
<td>номера колонок</td>
<td>2<br></td>
<td><br></td>
<td><br></td>
<td>кол-во<br></td>
</tr>
<tr>
<td><b><br></b></td>
<td><br></td>
<td><br></td>
<td>4<br></td>
<td><br></td>
<td>номер колонки<br></td>
</tr>
<tr>
<td><br></td>
<td>колонки</td>
<td>2</td>
<td><br></td>
<td><br></td>
<td>кол-во = предедущ.</td>
</tr>
<tr>
<td><br></td>
<td><br></td>
<td><br></td>
<td>30<br></td>
<td><br></td>
<td><a href="#PropCol">св-ва ячейки для кол.</a><br></td>
</tr>
<tr>
<td><b>строки</b></td>
<td>номера строк</td>
<td>2</td>
<td><br></td>
<td><br></td>
<td>кол-во<br></td>
</tr>
<tr>
<td><b><br></b></td>
<td><br></td>
<td><br></td>
<td>4<br></td>
<td><br></td>
<td>номер строки<br></td>
</tr>
<tr>
<td><b><br></b></td>
<td>строки</td>
<td>2<br></td>
<td><br></td>
<td><br></td>
<td>кол-во = предедущ.</td>
</tr>
<tr>
<td><b><br></b></td>
<td><br></td>
<td><br></td>
<td>30<br></td>
<td><br></td>
<td><a href="#PropRow">св-ва ячейки для стр.</a><br></td>
</tr>
<tr>
<td><b>ячейки</b></td>
<td>номера колонок</td>
<td><br></td>
<td>2<br></td>
<td><br></td>
<td>кол-во<br></td>
</tr>
<tr>
<td><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
<td>4</td>
<td>номер колонки<br></td>
</tr>
<tr>
<td><br></td>
<td>ячейки</td>
<td><br></td>
<td>2</td>
<td><br></td>
<td>кол-во = предедущ.</td>
</tr>
<tr>
<td><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
<td>30+</td>
<td><a href="#PropSel">св-ва ячейки</a></td>
</tr>
<tr>
<td><br></td>
<td>текст</td>
<td><br></td>
<td><br></td>
<td>+<br></td>
<td>текст</td>
</tr>
<tr>
<td><b><br></b></td>
<td>расшифровка</td>
<td><br></td>
<td><br></td>
<td>+<br></td>
<td>расшифровка</td>
</tr>
<tr>
<td><b>рисунки</b></td>
<td>рисунки вставляемые</td>
<td>2<br></td>
<td><br></td>
<td><br></td>
<td>кол-во<br></td>
</tr>
<tr>
<td><br></td>
<td><br></td>
<td><br></td>
<td>30+<br></td>
<td><br></td>
<td><a href="#Obj1">св-ва ячейки для рис.</a><br></td>
</tr>
<tr>
<td><br></td>
<td><br></td>
<td><br></td>
<td>40<br></td>
<td><br></td>
<td><a href="#ObjGlb">св-ва рисунка</a><br></td>
</tr>
<tr>
<td><br></td>
<td><br></td>
<td><br></td>
<td>+<br></td>
<td><br></td>
<td><a href="#Obj2">рисунок</a>, <a href="#Obj3">OLE</a><br></td>
</tr>
<tr>
<td><b>объединение</b></td>
<td>объединение</td>
<td>2<br></td>
<td><br></td>
<td><br></td>
<td>кол-во</td>
</tr>
<tr>
<td><br></td>
<td><br></td>
<td><br></td>
<td>16<br></td>
<td><br></td>
<td><a href="#Merge">св-ва объединения</a><br></td>
</tr>
<tr>
<td><b>секции</b></td>
<td>секции вертикальные</td>
<td>2</td>
<td><br></td>
<td><br></td>
<td>кол-во</td>
</tr>
<tr>
<td><br></td>
<td><br></td>
<td><br></td>
<td>13+<br></td>
<td><br></td>
<td><a href="#Sect">св-ва секции<br></a></td>
</tr>
<tr>
<td><br></td>
<td><br></td>
<td><br></td>
<td>+<br></td>
<td><br></td>
<td>имя<br></td>
</tr>
<tr>
<td><br></td>
<td>секции горизонтальные</td>
<td>2</td>
<td><br></td>
<td><br></td>
<td>кол-во</td>
</tr>
<tr>
<td><b><br></b></td>
<td><br></td>
<td><br></td>
<td>13+<br></td>
<td><br></td>
<td><a href="#Sect">св-ва секции</a><br></td>
</tr>
<tr>
<td><br></td>
<td><br></td>
<td><br></td>
<td>+<br></td>
<td><br></td>
<td>имя<br></td>
</tr>
<tr>
<td><b>переводы страниц</b></td>
<td>переводы страниц вертикальные</td>
<td>2<br></td>
<td><br></td>
<td><br></td>
<td>кол-во<br></td>
</tr>
<tr>
<td><br></td>
<td><br></td>
<td><br></td>
<td>4<br></td>
<td><br></td>
<td>номера колонок после<br></td>
</tr>
<tr>
<td><br></td>
<td>переводы страниц горизонтальные</td>
<td>2<br></td>
<td><br></td>
<td><br></td>
<td>кол-во<br></td>
</tr>
<tr>
<td><br></td>
<td><br></td>
<td><br></td>
<td>4</td>
<td><br></td>
<td>номера строк после</td>
</tr>
<tr>
<td><b>имена</b></td>
<td>имена</td>
<td>4<br></td>
<td><br></td>
<td><br></td>
<td>кол-во<br></td>
</tr>
<tr>
<td><br></td>
<td><br></td>
<td><br></td>
<td>1<br></td>
<td><br></td>
<td>длина имени<br></td>
</tr>
<tr>
<td><br></td>
<td><br></td>
<td><br></td>
<td>+<br></td>
<td><br></td>
<td>имя<br></td>
</tr>
<tr>
<td><br></td>
<td><br></td>
<td><br></td>
<td>28<br></td>
<td><br></td>
<td><a href="#Name">св-ва имени</a><br></td>
</tr>
</tbody>
</table>
<br>
<hr>
<h2><a id="begin" name="begin"></a>Заголовок файла</h2>
<table border="1" cellspacing="2" cellpadding="2">
<tbody>
<tr>
<td>Смещение<br></td>
<td>Длина<br></td>
<td>Знач.<br></td>
<td>Комментарий<br></td>
</tr>
<tr>
<td>0x00<br></td>
<td>6<br></td>
<td><br></td>
<td>"MOXCEL"<br></td>
</tr>
<tr>
<td>0x0b</td>
<td><br></td>
<td>0x06<br></td>
<td>?<br></td>
</tr>
<tr>
<td>0x0d</td>
<td>4<br></td>
<td>0-<br></td>
<td>Номер максимальной колонки<br></td>
</tr>
<tr>
<td>0x11</td>
<td>4<br></td>
<td>0-</td>
<td>Номер максимальной строки<br></td>
</tr>
<tr>
<td>0x15</td>
<td>4<br></td>
<td>0-<br></td>
<td>Количество рисунков (объектов) или последний номер
объекта<br></td>
</tr>
</tbody>
</table>
<br>
<hr>
<h2><a id="PropSel" name="PropSel"></a>Свойства ячейки (общие
св-ва)</h2>
Флажки:<br>
    - (изменение) устанавливает если хоть раз св-во изменилось и
больше не сбрасывается.<br>
    - (не авто) если значение установить в "Авто", флажок
сбрасывается,<br>
      а сопутствующие значения (цветов) остаются, т. е. флажок
может быть сброшен = 0,<br>
      но значение (цвета) быть не нулевым, ведь 0 = первый цвет
(черный).<br>
    - (длина &gt; 0) если длина строки = 0, флажок
сбрасывается.<br>
<table border="1" cellspacing="2" cellpadding="2">
<tbody>
<tr>
<td>Смещение<br></td>
<td>Длина<br></td>
<td>Знач.<br></td>
<td>Комментарий<br></td>
<td>По умолч.<br></td>
</tr>
<tr>
<td><br></td>
<td><br></td>
<td><br></td>
<td><b>Флажки</b></td>
<td><br></td>
</tr>
<tr>
<td><a id="pc00" name="pc00"></a>0x00</td>
<td>1<br></td>
<td>0x01<br>
0x02<br>
0x04<br>
0x08<br>
0x10<br>
0x20<br>
0x40<br>
0x80<br></td>
<td><a href="#pc08">Шрифт - Имя</a> (не авто)<br>
<a href="#pc0a">Шрифт - Размер</a> (не авто)<br>
<a href="#pc0c">Шрифт - Жирный</a> (изменение)<br>
<a href="#pc0d">Шрифт - Наклонный</a> (изменение)<br>
<a href="#pc0e">Шрифт - Подчеркнутый</a> (изменение)<br>
<a href="#pc12">Рамка - Лево</a> (изменение)<br>
<a href="#pc13">Рамка - Верх</a> (изменение)<br>
<a href="#pc14">Рамка - Право</a> (изменение)<br></td>
<td>0<br></td>
</tr>
<tr>
<td><a id="pc01" name="pc01"></a>0x01</td>
<td>1<br></td>
<td>0x01<br>
0x02<br>
0x04<br>
0x08<br>
0x10<br>
<br>
0x20<br>
0x40<br>
0x80<br></td>
<td><a href="#pc15">Рамка - Низ</a> (изменение)<br>
<a href="#pc17">Цвет рамок</a> (не авто)<br>
Флажок общий № 1 (исп. в других св-вах)<br>
Флажок общий № 2 (исп. в других св-вах)<br>
<a href="#pc0f">По горизонтали</a> (изменение)<br>
<a href="#pc0f">По выделенным столбцам</a> (изменение)<br>
<a href="#pc10">По вертикали</a> (изменение)<br>
<a href="#pc18">Цвет шрифта</a> (не авто)<br>
<a href="#pc19">Фон</a> (не авто)<br></td>
<td>0<br></td>
</tr>
<tr>
<td><a id="pc02" name="pc02"></a>0x02<br></td>
<td>1<br></td>
<td>0x01<br>
0x02<br>
0x04<br>
0x08<br>
0x10<br></td>
<td><a href="#pc11">Узор</a> (не авто)<br>
<a href="#pc16">Цвет узора</a> (не авто)<br>
<a href="#pc1a">Контроль</a> (изменение)<br>
<a href="#pc1b">Тип</a> (изменение)<br>
<a href="#pc1c">Защита</a> (изменение)<br></td>
<td>0<br></td>
</tr>
<tr>
<td><a id="pc03" name="pc03"></a>0x03</td>
<td>1<br></td>
<td>0x40<br>
0x80<br></td>
<td><a href="#pc_d">Расшифровка</a> (длина &gt; 0)<br>
<a href="#pc_t">Текст</a> (длина &gt; 0)<br></td>
<td>0<br></td>
</tr>
<tr>
<td><br></td>
<td><br></td>
<td><br></td>
<td><b>Значения</b></td>
<td><br></td>
</tr>
<tr>
<td><a id="pc04" name="pc04"></a>0x04<br></td>
<td>2<br></td>
<td><br></td>
<td>Значение общие № 1 (исп. в других св-вах)</td>
<td><br></td>
</tr>
<tr>
<td><a id="pc06" name="pc06"></a>0x06</td>
<td>2<br></td>
<td><br></td>
<td>Значение общие № 2 (исп. в других св-вах)</td>
<td><br></td>
</tr>
<tr>
<td><a id="pc08" name="pc08"></a>0x08</td>
<td>2(?)<br></td>
<td>1-<br></td>
<td>Номер Имени шрифта<br></td>
<td>= Arial (задается в конфигураторе)<br></td>
</tr>
<tr>
<td><a id="pc0a" name="pc0a"></a>0x0a</td>
<td>2<br></td>
<td>р<br></td>
<td>Шрифт - Размер<br>
8=-32,  9=-36,  10=-40, 11=-44<br>
размер = -р/4</td>
<td>= 8 (задается в конфигураторе)</td>
</tr>
<tr>
<td><a id="pc0c" name="pc0c"></a>0x0c</td>
<td>1<br></td>
<td>4<br>
7<br></td>
<td>Шрифт - Жирный = 0<br>
Шрифт - Жирный = 1<br></td>
<td>0</td>
</tr>
<tr>
<td><a id="pc0d" name="pc0d"></a>0x0d</td>
<td>1<br></td>
<td>0<br>
1<br></td>
<td>Шрифт - Наклонный = 0<br>
Шрифт - Наклонный = 1<br></td>
<td>0<br></td>
</tr>
<tr>
<td><a id="pc0e" name="pc0e"></a>0x0e</td>
<td>1<br></td>
<td>0<br>
1</td>
<td>Шрифт - Подчеркнутый = 0<br>
Шрифт - Подчеркнутый = 1</td>
<td>0</td>
</tr>
<tr>
<td><a id="pc0f" name="pc0f"></a>0x0f<br></td>
<td>1<br></td>
<td>0<br>
2<br>
4<br>
6<br>
0x20<br></td>
<td>По горизонтали = Лево<br>
По горизонтали = Право<br>
По горизонтали = По ширине<br>
По горизонтали = Центр<br>
По выделенным столбцам = 1<br></td>
<td>По горизонтали = Лево,<br>
По выделенным столбцам = 0<br></td>
</tr>
<tr>
<td><a id="pc10" name="pc10"></a>0x10<br></td>
<td>1<br></td>
<td>0<br>
0x08<br>
0x18<br></td>
<td>По вертикали = Верх<br>
По вертикали = Низ<br>
По вертикали = Центр<br></td>
<td>= Низ</td>
</tr>
<tr>
<td><a id="pc11" name="pc11"></a>0x11</td>
<td>1<br></td>
<td>0-15<br></td>
<td><a href="#r2">Узор</a> = Номер узора<br>
(отсчет слева - направо, сверху - вниз)<br>
При "Авто" сохраняет номер старого номера<br></td>
<td>= Авто<br></td>
</tr>
<tr>
<td><a id="pc12" name="pc12"></a>0x12</td>
<td>1<br></td>
<td>0-9<br></td>
<td><a href="#r3">Рамка - Лево</a> = Номер стиля рамки<br>
(отсчет особый)<br></td>
<td>0</td>
</tr>
<tr>
<td><a id="pc13" name="pc13"></a>0x13</td>
<td>1<br></td>
<td>0-9<br></td>
<td><a href="#r3">Рамка - Верх</a> = Номер стиля рамки<br>
(отсчет особый)<br></td>
<td>0</td>
</tr>
<tr>
<td><a id="pc14" name="pc14"></a>0x14</td>
<td>1<br></td>
<td>0-9<br></td>
<td><a href="#r3">Рамка - Право</a> = Номер стиля рамки<br>
(отсчет особый)<br></td>
<td>0</td>
</tr>
<tr>
<td><a id="pc15" name="pc15"></a>0x15</td>
<td>1<br></td>
<td>0-9<br></td>
<td><a href="#r3">Рамка - Низ</a> = Номер стиля рамки<br>
(отсчет особый)<br></td>
<td>0</td>
</tr>
<tr>
<td><a id="pc16" name="pc16"></a>0x16<br></td>
<td>1<br></td>
<td>0-55<br></td>
<td><a href="#r1">Цвет узора</a> = Номер цвета<br>
(отсчет слева - направо, сверху - вниз)<br></td>
<td>= Авто<br></td>
</tr>
<tr>
<td><a id="pc17" name="pc17"></a>0x17<br></td>
<td>1<br></td>
<td>0-55<br></td>
<td><a href="#r1">Цвет рамок</a> = Номер цвета<br>
(отсчет слева - направо, сверху - вниз)<br></td>
<td>= Авто</td>
</tr>
<tr>
<td><a id="pc18" name="pc18"></a>0x18<br></td>
<td>1<br></td>
<td>0-55<br></td>
<td><a href="file:///C:/Dev/1C/moxcel_docs/moxcel.html#r1">Цвет
шрифта</a> = Номер цвета<br>
(отсчет слева - направо, сверху - вниз)</td>
<td>= Авто<br></td>
</tr>
<tr>
<td><a id="pc19" name="pc19"></a>0x19</td>
<td>1<br></td>
<td>0-55<br></td>
<td><a href="#r1">Фон</a> = Номер цвета<br>
<a href="mxl_bgc.html">(отсчет слева - направо, сверху -
вниз)</a><br></td>
<td>= Авто<br></td>
</tr>
<tr>
<td><a id="pc1a" name="pc1a"></a>0x1a<br></td>
<td>1<br></td>
<td>0<br>
1<br>
2<br>
3<br>
4<br>
5<br></td>
<td>Контроль = Авто<br>
Контроль = Обрезать<br>
Контроль = Забивать<br>
Контроль = Переносить<br>
Контроль = Красный<br>
Контроль = Забивать + Красный<br></td>
<td>= Авто</td>
</tr>
<tr>
<td><a id="pc1b" name="pc1b"></a>0x1b<br></td>
<td>1<br></td>
<td>0<br>
1<br>
2<br>
3<br></td>
<td>Тип = Текст<br>
Тип = Выражение<br>
Тип = Шаблон<br>
Тип = Фикс. шаблон<br></td>
<td>= Текст</td>
</tr>
<tr>
<td><a id="pc1c" name="pc1c"></a>0x1c<br></td>
<td>1<br></td>
<td>1<br></td>
<td>Защита = 0,<br>
т. е. инверсия!<br></td>
<td>= 1 (0)<br></td>
</tr>
<tr>
<td><a id="pc1d" name="pc1d"></a>0x1d</td>
<td><br></td>
<td><br></td>
<td>?<br></td>
<td><br></td>
</tr>
<tr>
<td><br></td>
<td><br></td>
<td><br></td>
<td><b>Блок Текста</b><br></td>
<td><br></td>
</tr>
<tr>
<td><a id="pc_t" name="pc_t"></a>0x00<br>
0x00+<br>
0x01<br></td>
<td>1(*)<br>
2(**)<br>
дл1<br></td>
<td>дл1(1)<br>
дл1(2)<br>
<br></td>
<td>Длина Текста (?(&lt;255, дл, 0xff))<br>
Длина Текста (?(&gt;=255, дл, ""))<br>
Текст<br></td>
<td>= "" (Нет)<br></td>
</tr>
<tr>
<td><br></td>
<td><br></td>
<td><br></td>
<td><b>Блок Расшифровки</b></td>
<td><br></td>
</tr>
<tr>
<td><a id="pc_d" name="pc_d"></a>0x00<br>
0x00+<br>
0x01</td>
<td>1(*)<br>
2(**)<br>
дл2</td>
<td>дл2(1)<br>
дл2(2)<br>
<br></td>
<td>Длина Расшифровки (?(&lt;255, дл, 0xff))<br>
Длина Расшифровки (?(&gt;=255, дл, ""))<br>
Расшифровка</td>
<td>= "" (Нет)</td>
</tr>
<tr>
<td><br></td>
<td><br></td>
<td><br></td>
<td>* - Блок Текста и Расшифровки, вставляются после блока Ячейки,
только в том случае, если длина  строки их текста больше нуля. И в
порядке приведенном в таблице - Текст, Расшифровка.<br>
** - если длина текста больше 254, то она записывается 3 байтами,
первый - 0xff, далее идет слово - длина текста.<br></td>
<td><br></td>
</tr>
</tbody>
</table>
<br>
<hr width="100%" size="2">
<h2><a id="PropSelByGr" name="PropSelByGr"></a>Свойства ячейки по
группам</h2>
<table cellpadding="2" cellspacing="2" border="1">
<tbody>
<tr>
<td width="150"><b>Группа<br></b></td>
<td><b>Название значения<br></b></td>
<td><b>Смещ.<br>
флага<br></b></td>
<td><b>Знач.<br>
флага<br></b></td>
<td><b>Смещ.<br>
знач.<br></b></td>
</tr>
<tr>
<td><b>Текст</b></td>
<td><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
</tr>
<tr>
<td width="150"><b><br></b></td>
<td>Тип<br></td>
<td><a href="#pc02">0x02</a></td>
<td>0x08</td>
<td><a href="#pc1b">0x1b</a></td>
</tr>
<tr>
<td width="150"><b><br></b></td>
<td>Контроль<br></td>
<td><a href="#pc02">0x02</a></td>
<td>0x04</td>
<td><a href="#pc1a">0x1a</a></td>
</tr>
<tr>
<td width="150"><b><br></b></td>
<td>Текст (Значение)<br></td>
<td><a href="#pc03">0x03</a></td>
<td>0x80</td>
<td><a href="#pc_t">0x1d+</a></td>
</tr>
<tr>
<td width="150"><b><br></b></td>
<td>Расшифровка<br></td>
<td><a href="#pc03">0x03</a></td>
<td>0x40</td>
<td><a href="#pc_d">0x1d+</a></td>
</tr>
<tr>
<td width="150"><b><br></b></td>
<td>Защита<br></td>
<td><a href="#pc02">0x02</a></td>
<td>0x10</td>
<td><a href="#pc1c">0x1c</a></td>
</tr>
<tr>
<td width="150"><b>Положение<br></b></td>
<td><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
</tr>
<tr>
<td width="150"><b><br></b></td>
<td>По горизонтали<br></td>
<td><a href="#pc01">0x01</a></td>
<td>0x10</td>
<td><a href="#pc0f">0x0f</a></td>
</tr>
<tr>
<td width="150"><b><br></b></td>
<td>По выделенным столбцам<br></td>
<td><a href="#pc01">0x01</a></td>
<td>0x10</td>
<td><a href="#pc0f">0x0f</a></td>
</tr>
<tr>
<td width="150"><b><br></b></td>
<td>По вертикали<br></td>
<td><a href="#pc01">0x01</a></td>
<td>0x20</td>
<td><a href="#pc10">0x10</a></td>
</tr>
<tr>
<td width="150"><b>Шрифт<br></b></td>
<td><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
</tr>
<tr>
<td width="150"><b><br></b></td>
<td>Имя<br></td>
<td><a href="#pc00">0x00</a></td>
<td>0x01</td>
<td><a href="#pc08">0x08</a></td>
</tr>
<tr>
<td width="150"><b><br></b></td>
<td>Размер<br></td>
<td><a href="#pc00">0x00</a></td>
<td>0x02</td>
<td><a href="#pc0a">0x0a</a></td>
</tr>
<tr>
<td width="150"><b><br></b></td>
<td>Жирный<br></td>
<td><a href="#pc00">0x00</a></td>
<td>0x04</td>
<td><a href="#pc0c">0x0c</a></td>
</tr>
<tr>
<td width="150"><b><br></b></td>
<td>Наклонный<br></td>
<td><a href="#pc00">0x00</a></td>
<td>0x08</td>
<td><a href="#pc0d">0x0d</a></td>
</tr>
<tr>
<td width="150"><b><br></b></td>
<td>Подчеркнутый<br></td>
<td><a href="#pc00">0x00</a></td>
<td>0x10</td>
<td><a href="#pc0e">0x0e</a></td>
</tr>
<tr>
<td width="150"><b><br></b></td>
<td>Цвет<br></td>
<td><a href="#pc01">0x01</a></td>
<td>0x40</td>
<td><a href="#pc18">0x18</a></td>
</tr>
<tr>
<td width="150"><b>Рамка<br></b></td>
<td><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
</tr>
<tr>
<td width="150"><b><br></b></td>
<td>Лево<br></td>
<td><a href="#pc00">0x00</a></td>
<td>0x20</td>
<td><a href="#pc12">0x12</a></td>
</tr>
<tr>
<td width="150"><b><br></b></td>
<td>Верх<br></td>
<td><a href="#pc00">0x00</a></td>
<td>0x40</td>
<td><a href="#pc13">0x13</a></td>
</tr>
<tr>
<td width="150"><b><br></b></td>
<td>Право<br></td>
<td><a href="#pc00">0x00</a></td>
<td>0x80</td>
<td><a href="#pc14">0x14</a></td>
</tr>
<tr>
<td width="150"><b><br></b></td>
<td>Низ<br></td>
<td><a href="#pc01">0x01</a></td>
<td>0x01</td>
<td><a href="#pc15">0x15</a></td>
</tr>
<tr>
<td width="150"><b><br></b></td>
<td>Обвести<br></td>
<td><br></td>
<td><br></td>
<td><br></td>
</tr>
<tr>
<td width="150"><b><br></b></td>
<td>Цвет<br></td>
<td><a href="#pc01">0x01</a></td>
<td>0x02</td>
<td><a href="#pc17">0x17</a></td>
</tr>
<tr>
<td width="150"><b>Узор<br></b></td>
<td><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
</tr>
<tr>
<td width="150"><b><br></b></td>
<td>Фон<br></td>
<td><a href="#pc01">0x01</a></td>
<td>0x80</td>
<td><a href="#pc19">0x19</a></td>
</tr>
<tr>
<td width="150"><b><br></b></td>
<td>Узор<br></td>
<td><a href="#pc02">0x02</a></td>
<td>0x01</td>
<td><a href="#pc11">0x11</a></td>
</tr>
<tr>
<td width="150"><b><br></b></td>
<td>Цвет<br></td>
<td><a href="#pc02">0x02</a></td>
<td>0x02</td>
<td><a href="#pc16">0x16</a></td>
</tr>
<tr>
<td width="150"><b>+ Колонки</b><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
</tr>
<tr>
<td width="150"><br></td>
<td>Положение на странице верт.<br></td>
<td><a href="#pc01">0x01</a></td>
<td>0x04</td>
<td><a href="#pc04">0x04</a></td>
</tr>
<tr>
<td width="150"><br></td>
<td>Ширина колонки<br></td>
<td><a href="#pc01">0x01</a></td>
<td>0x08</td>
<td><a href="#pc06">0x06</a></td>
</tr>
<tr>
<td width="150"><b>+ Строки</b><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
</tr>
<tr>
<td width="150"><br></td>
<td>Высота строки<br></td>
<td><a href="#pc01">0x01</a><br></td>
<td>0x04</td>
<td><a href="#pc04">0x04</a><br></td>
</tr>
<tr>
<td width="150"><br></td>
<td>Положение на странице гориз.<br></td>
<td><a href="#pc01">0x01</a></td>
<td>0x08</td>
<td><a href="#pc06">0x06</a></td>
</tr>
<tr>
<td width="150"><b>+ Колонтитулы</b><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
</tr>
<tr>
<td width="150"><br></td>
<td>Выводить с:<br></td>
<td><a href="#pc01">0x01</a></td>
<td>0x04</td>
<td><a href="#pc04">0x04</a></td>
</tr>
<tr>
<td width="150"><br></td>
<td>номер страница</td>
<td><a href="#pc01">0x01</a></td>
<td>0x08</td>
<td><a href="#pc06">0x06</a></td>
</tr>
</tbody>
</table>
<br>
<hr width="100%" size="2">
<h2><a id="r1" name="r1"></a>Рисунки Цвета</h2>
<img src="mxl_bgc.png" alt="Цвет" width="126" height="110"><br>
(отсчет слева - направо, сверху - вниз)<br>
(<a href="colours.html">вариант</a> - сделан при помощи Gimp,
достоверность не гарантируется)<br>
<br>
<hr width="100%" size="2">
<h2><a id="r2" name="r2"></a>Рисунки Узора</h2>
<img src="mxl_bg.png" alt="Узор" width="128" height="32"><br>
(отсчет слева - направо, сверху - вниз)<br>
<br>
<hr width="100%" size="2">
<h2><a id="r3" name="r3"></a>Рисунки Стилей рамки</h2>
<table>
<tbody>
<tr>
<td><img src="mxl_stl.png" alt="Стили рамки" width="87" height=
"96"><br></td>
<td>
<table>
<tbody>
<tr>
<td>0<br></td>
<td>4<br></td>
</tr>
<tr>
<td>1<br></td>
<td>5<br></td>
</tr>
<tr>
<td>8<br></td>
<td>6<br></td>
</tr>
<tr>
<td>2<br></td>
<td>7<br></td>
</tr>
<tr>
<td>3<br></td>
<td>9<br></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
(отсчет особый - примерно сверху - вниз, слева - направо)<br>
<br>
<hr>
<h2><a id="PropT" name="PropT"></a>Изменения для свойств
таблицы</h2>
Отличия от <a href="#PropSel">св-в ячейки</a><br>
<table cellpadding="2" cellspacing="2" border="1">
<tbody>
<tr>
<td><b>Смещение</b></td>
<td><b>Длина</b></td>
<td><b>Знач.</b></td>
<td><b>Комментарий</b></td>
<td><b>По умолч.</b></td>
</tr>
<tr>
<td><b>Флажки</b><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
</tr>
<tr>
<td>0x01</td>
<td>1<br></td>
<td>0x08</td>
<td>?<br></td>
<td>0x08</td>
</tr>
<tr>
<td><b>Значение</b><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
</tr>
<tr>
<td>0x06</td>
<td>2<br></td>
<td>0x0048</td>
<td>?<br></td>
<td>0x0048</td>
</tr>
</tbody>
</table>
<br>
<hr>
<h2><a id="PropPH" name="PropPH"></a>Изменения для свойств
колонтитулов<br></h2>
Отличия от <a href="#PropSel">св-в ячейки</a><br>
<table cellpadding="2" cellspacing="2" border="1">
<tbody>
<tr>
<td><b>Смещение</b></td>
<td><b>Длина</b></td>
<td><b>Знач.</b></td>
<td><b>Комментарий</b></td>
<td><b>По умолч.<br></b></td>
</tr>
<tr>
<td><b>Флажки</b><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
</tr>
<tr>
<td>0x01</td>
<td>1<br></td>
<td><br></td>
<td>0x04 = Выводить с: (изменение)<br>
0x08 = Номер страницы (изменение)</td>
<td><br></td>
</tr>
<tr>
<td><b>Значения</b><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
</tr>
<tr>
<td>0x04</td>
<td>2<br></td>
<td><br></td>
<td>Выводить с:<br>
1 = да (отметка галочкой)<br>
0xffff = нет</td>
<td>1<br></td>
</tr>
<tr>
<td>0x06</td>
<td>2<br></td>
<td><br></td>
<td>Выводить с: номер страницы</td>
<td>1</td>
</tr>
</tbody>
</table>
<br>
<hr>
<h2><a id="PropCol" name="PropCol"></a>Изменения для свойств
колонки</h2>
Отличия от <a href="#PropSel">св-в ячейки</a><br>
<table border="1" cellspacing="2" cellpadding="2">
<tbody>
<tr>
<td><b>Смещение</b></td>
<td><b>Длина</b></td>
<td><b>Знач.</b></td>
<td><b>Комментарий</b></td>
<td><b>По умолч.<br></b></td>
</tr>
<tr>
<td><b>Флажки</b><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
</tr>
<tr>
<td>0x01</td>
<td>1<br></td>
<td><br>
<br>
<br></td>
<td>0x04 = Положение на странице (изменение)<br>
0x08 = Ширина колонки (не авто)</td>
<td>0<br>
<br>
Авто=0</td>
</tr>
<tr>
<td><b>Значения</b><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
</tr>
<tr>
<td>0x04</td>
<td>2<br></td>
<td><br></td>
<td>Положение на странице верт.<br>
0x01 = с новой строки<br>
0x02 =  вместе со следующим<br>
(значения могут суммироваться)</td>
<td>0<br></td>
</tr>
<tr>
<td>0x06</td>
<td>2<br></td>
<td>ш</td>
<td>Ширина колонки<br>
30=240,  45=360<br>
ширина = ш/8<br>
(При авто сохр. старое знач.)</td>
<td>Авто=0, (ширина = 9)</td>
</tr>
</tbody>
</table>
<br>
<hr>
<h2><a id="PropRow" name="PropRow"></a>Изменения для свойств
строки</h2>
Отличия от <a href="#PropSel">св-в ячейки</a><br>
<table cellpadding="2" cellspacing="2" border="1">
<tbody>
<tr>
<td><b>Смещение</b></td>
<td><b>Длина</b></td>
<td><b>Знач.</b></td>
<td><b>Комментарий</b></td>
<td><b>По умолч.<br></b></td>
</tr>
<tr>
<td><b>Флажки</b><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
</tr>
<tr>
<td>0x01</td>
<td>1<br></td>
<td><br>
<br></td>
<td>0x04 = Высота строки (изменение)<br>
0x08 = Положение на странице (изменение)</td>
<td><br></td>
</tr>
<tr>
<td><b>Значения</b><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
</tr>
<tr>
<td>0x04</td>
<td>2<br></td>
<td>в</td>
<td>Высота строки<br>
30=120,  60=240<br>
высота = в/4</td>
<td>Авто=0, (высота=11,25)</td>
</tr>
<tr>
<td>0x06</td>
<td>2<br></td>
<td><br></td>
<td>Положение на странице гориз.<br>
0x01 = с новой строки<br>
0x02 = вместе со следующим<br>
(значения могут суммироваться)</td>
<td>0</td>
</tr>
</tbody>
</table>
<br>
<hr>
<h2><a id="Obj1" name="Obj1"></a>Изменения для свойств ячейки
рисунка<br></h2>
Отличия от <a href="#PropSel">св-в ячейки</a>. Изменилась вкладка
"Рамка" на "Линия".<br>
<table border="1" cellspacing="2" cellpadding="2">
<tbody>
<tr>
<td>Смещение<br></td>
<td>Длина<br></td>
<td>Знач.<br></td>
<td>Комментарий<br></td>
<td>По умолч.<br></td>
</tr>
<tr>
<td><b>Флажки</b><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
</tr>
<tr>
<td>0x00</td>
<td>1<br></td>
<td>0x20<br>
0x40<br>
0x80<br></td>
<td>Стиль (изменения)<br>
Толщина (изменения)<br>
Рамки (изменения)<br></td>
<td><br></td>
</tr>
<tr>
<td>0x01<br></td>
<td>1<br></td>
<td>0xa0<br>
0x01<br></td>
<td>По умолчанию (Цвет шрифта=0, фон=1)<br>
Выводить на печать (изменения)<br></td>
<td>0xa0<br></td>
</tr>
<tr>
<td>0x02</td>
<td>1<br></td>
<td>0x08<br></td>
<td>Тип текста<br>
(по умолчанию для рисунка, OLE, диаграммы)<br></td>
<td>0x08</td>
</tr>
<tr>
<td><b>Значения</b><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
</tr>
<tr>
<td>0x12<br></td>
<td>1<br></td>
<td>0-5<br></td>
<td>Стиль<br></td>
<td>Стиль=1</td>
</tr>
<tr>
<td>0x13</td>
<td>1<br></td>
<td>0-2</td>
<td>Толщина</td>
<td>Толщина=0</td>
</tr>
<tr>
<td>0x14</td>
<td>1<br></td>
<td><br>
0x01<br>
0x02<br>
0x04<br>
0x08<br></td>
<td>Рамки<br>
Слева<br>
Сверху<br>
Справа<br>
Снизу<br></td>
<td>=0x0f<br></td>
</tr>
<tr>
<td>0x15</td>
<td>1<br></td>
<td>0-1<br></td>
<td>0 - Выводить на печать<br>
1 - Не выводить на печать (инверсия)<br></td>
<td>Выводить на печать = 0<br></td>
</tr>
<tr>
<td>0x1b<br></td>
<td>1<br></td>
<td>0x04<br></td>
<td>Тип текста = ? (комментарий)<br>
(по умолчанию для рисунка, OLE, диаграммы)<br></td>
<td>0x04</td>
</tr>
</tbody>
</table>
<br>
<hr size="2" width="100%">
<h2><a id="ObjGlb" name="ObjGlb"></a>Свойства рисунка
(дополнительные)<br></h2>
Общие для всех рисунков<br>
<table cellpadding="2" cellspacing="2" border="1">
<tbody>
<tr>
<td>Смещение<br></td>
<td>Длина<br></td>
<td>Знач.<br></td>
<td>Комментарий<br></td>
<td>По умолч.<br></td>
</tr>
<tr>
<td>0x00<br></td>
<td>4(?)</td>
<td><br>
1<br>
2<br>
3<br>
4<br>
5<br></td>
<td>Объект:<br>
Линия<br>
Прямоугольник<br>
Текст<br>
OLE, Диаграмма<br>
Рисунок<br></td>
<td><br></td>
</tr>
<tr>
<td>0x04<br></td>
<td>4<br></td>
<td>0-</td>
<td>Номер колонки начальной ячейки</td>
<td><br></td>
</tr>
<tr>
<td>0x08</td>
<td>4<br></td>
<td>0-</td>
<td>Номер строки начальной ячейки</td>
<td><br></td>
</tr>
<tr>
<td>0x0с</td>
<td>4<br></td>
<td>0-</td>
<td>Смещение X относительно верхнего левого угла<br>
начальной ячейки в ?</td>
<td><br></td>
</tr>
<tr>
<td>0x10</td>
<td>4<br></td>
<td>0-</td>
<td>Смещение Y относительно верхнего левого угла<br>
начальной ячейки в ?</td>
<td><br></td>
</tr>
<tr>
<td>0x14<br></td>
<td>4<br></td>
<td>0-<br></td>
<td>Номер колонки конечной ячейки<br></td>
<td><br></td>
</tr>
<tr>
<td>0x18</td>
<td>4<br></td>
<td>0-<br></td>
<td>Номер строки конечной ячейки</td>
<td><br></td>
</tr>
<tr>
<td>0x1с</td>
<td>4<br></td>
<td>0-<br></td>
<td>Смещение X относительно верхнего левого угла<br>
конечной ячейки в ?<br></td>
<td><br></td>
</tr>
<tr>
<td>0x20</td>
<td>4<br></td>
<td>0-<br></td>
<td>Смещение Y относительно верхнего левого угла<br>
конечной ячейки в ?</td>
<td><br></td>
</tr>
<tr>
<td>0x24<br></td>
<td>4(?)<br></td>
<td>1-<br></td>
<td>Уровень плана (?), связано с командами<br>
на передний, задний план<br></td>
<td><br></td>
</tr>
</tbody>
</table>
<br>
<hr width="100%" size="2">
<h2><a id="Obj2" name="Obj2"></a>Свойства рисунка
(рисунок)<br></h2>
Добавляется после дополнительных св-в (только для рисунка)<br>
Длина 8 байт + рисунок<br>
<table border="1" cellspacing="2" cellpadding="2">
<tbody>
<tr>
<td>Смещение<br></td>
<td>Длина<br></td>
<td>Знач.<br></td>
<td>Комментарий<br></td>
<td>По умолч.<br></td>
</tr>
<tr>
<td>0x00<br></td>
<td>4<br></td>
<td>0x746с<br></td>
<td>? = "lt\x00\x00"<br></td>
<td>0x0000746c</td>
</tr>
<tr>
<td>0x04</td>
<td>4<br></td>
<td>дл<br></td>
<td><br></td>
<td><br></td>
</tr>
<tr>
<td>0x04+</td>
<td>дл<br></td>
<td><br></td>
<td>Рисунок<br></td>
<td><br></td>
</tr>
</tbody>
</table>
<br>
<br>
<hr>
<h2><a id="Obj3" name="Obj3"></a>Свойства рисунка (OLE)<br></h2>
Добавляется после дополнительных св-в (только OLE, диаграммы)<br>
Длина 42(для прервого)/24(для остальных) байта + OLE<br>
<table cellpadding="2" cellspacing="2" border="1">
<tbody>
<tr>
<td>Смещение<br></td>
<td>Длина<br></td>
<td>Знач.<br></td>
<td>Комментарий<br></td>
<td>По умолч.<br></td>
</tr>
<tr>
<td><br></td>
<td><br></td>
<td><br></td>
<td><b>начало</b> (длина = 2)</td>
<td><br></td>
</tr>
<tr>
<td>0x00<br></td>
<td>2<br></td>
<td>0xffff<br>
0x8001<br></td>
<td>- Есть "строка имени OLE" (?)<br>
- Нет<br></td>
<td><br></td>
</tr>
<tr>
<td><br></td>
<td><br></td>
<td><br></td>
<td><b>строка имени OLE</b> (длина = 4*+14*)<br>
встречается только в первом OLE<br></td>
<td><br></td>
</tr>
<tr>
<td>0x00+2</td>
<td>2(*)</td>
<td>0<br></td>
<td>(?)<br>
* - Есть, только при 0x00 = 0xffff<br></td>
<td>0x00<br></td>
</tr>
<tr>
<td>0x00+4<br></td>
<td>2(*)<br></td>
<td>дл_об<br></td>
<td>Длина строки OLE (всегда 0x0e)<br>
* - Есть, только при 0x00 = 0xffff</td>
<td>0x0e<br></td>
</tr>
<tr>
<td>0x00+6<br></td>
<td>дл_об(*)<br></td>
<td><br></td>
<td>Строка OLE (всегда "CSheetCntrItem")<br>
* - Есть, только при 0x00 = 0xffff<br></td>
<td>"CSheetCntrItem"</td>
</tr>
<tr>
<td><br></td>
<td><br></td>
<td><br></td>
<td><b>продолжение</b> (длина = 22)</td>
<td><br></td>
</tr>
<tr>
<td>0x00</td>
<td>4<br></td>
<td>0x100<br></td>
<td>? = 256<br></td>
<td>0x00000100</td>
</tr>
<tr>
<td>0x02<br></td>
<td>4<br></td>
<td><br></td>
<td>Порядковый номер рисунка (?),<br>
от рис. к рис. увеличивается на 2 или 3<br></td>
<td><br></td>
</tr>
<tr>
<td>0x06<br></td>
<td>4<br></td>
<td><br></td>
<td>1 - для OLE<br>
0x0012f150 - для "Диаграммы"<br></td>
<td><br></td>
</tr>
<tr>
<td>0x0a<br></td>
<td>2<br></td>
<td>0<br></td>
<td>0<br></td>
<td>0x0000<br></td>
</tr>
<tr>
<td>0x0e</td>
<td>4<br></td>
<td>1<br></td>
<td>1</td>
<td>0x00000001</td>
</tr>
<tr>
<td>0x12</td>
<td>4<br></td>
<td>длOLE<br></td>
<td>Длина OLE объекта<br></td>
<td><br></td>
</tr>
<tr>
<td>0x12+1</td>
<td>длOLE</td>
<td><br></td>
<td>OLE</td>
<td><br></td>
</tr>
</tbody>
</table>
<br>
<hr>
<h2><a id="dialog" name="dialog"></a>Свойства ячейки
(модифицированные для диалога)</h2>
Отличия от <a href="#PropSel">св-в ячейки</a>. Добавилась вкладка
"Данные".<br>
<table cellpadding="2" cellspacing="2" border="1">
<tbody>
<tr>
<td><b>Смещение</b></td>
<td><b>Длина</b></td>
<td><b>Знач.</b></td>
<td><b>Комментарий</b></td>
<td><b>По умолч.</b></td>
</tr>
<tr>
<td><br></td>
<td><br></td>
<td><br></td>
<td><b>Флажки</b></td>
<td><br></td>
</tr>
<tr>
<td>0x02</td>
<td>1<br></td>
<td>0x20<br></td>
<td>Тип (изменения)<br></td>
<td><br></td>
</tr>
<tr>
<td>0x03<br></td>
<td>1<br></td>
<td><br></td>
<td>0x40 = Формула (длина &gt; 0)<br>
0x80 = Текст (длина &gt; 0)<br></td>
<td><br></td>
</tr>
<tr>
<td><br></td>
<td><br></td>
<td><br></td>
<td><b>Значения</b><br></td>
<td><br></td>
</tr>
<tr>
<td>0x1d+<br></td>
<td>0+1+дл<br></td>
<td><br></td>
<td>текст = значение (см. св-ва ячейки)<b><br></b></td>
<td><br></td>
</tr>
<tr>
<td>0x1d+<br></td>
<td>0+1+дл</td>
<td><br></td>
<td>формула (см. св-ва ячейки)</td>
<td><br></td>
</tr>
<tr>
<td><br></td>
<td><br></td>
<td><b>(длина=16+)</b></td>
<td><b>доп. св-ва</b></td>
<td><br></td>
</tr>
<tr>
<td>0x00<br></td>
<td>1<br></td>
<td>дл_с<br></td>
<td>Длина всех доп. св-в<br></td>
<td><br></td>
</tr>
<tr>
<td>0x04<br></td>
<td>1<br></td>
<td>0x03<br></td>
<td>? исп. в строке, число<br></td>
<td><br></td>
</tr>
<tr>
<td>0x06<br></td>
<td>1<br></td>
<td><br></td>
<td>Тип =<br>
0x41 = Вид расчета<br>
0x42 = Справочник<br>
0x43 = Календарь<br>
0x44 = Дата<br>
0x45 = Перечисление<br>
0x4b = Вид субконто<br>
0x4e = Число<br>
0x4f = Документ<br>
0x50 = План счетов<br>
0x53 = Строка<br>
0x53 = Счет<br>
0x55 = Неопределенный<br></td>
<td><br></td>
</tr>
<tr>
<td>0x07</td>
<td>1<br></td>
<td>0-<br></td>
<td>Длина (строки, числа и т. п.)<br></td>
<td><br></td>
</tr>
<tr>
<td>0x0b</td>
<td>1<br></td>
<td>0-<br></td>
<td>Точность (число)<br></td>
<td><br></td>
</tr>
<tr>
<td>0x0f</td>
<td>2<br></td>
<td>0-<br></td>
<td>? Номер вида<br>
справочника, документа, перечисления, и т.п.<br></td>
<td><br></td>
</tr>
<tr>
<td>0x13<br></td>
<td>1<br></td>
<td>0x01</td>
<td>Не отрицательный=1 (число)<br></td>
<td><br></td>
</tr>
<tr>
<td>0x14</td>
<td>1<br></td>
<td>0x01</td>
<td>Разделять триады=1 (число)</td>
<td><br></td>
</tr>
<tr>
<td>0x15</td>
<td>1(*)<br></td>
<td>дл_вз<br></td>
<td>? Длина внутреннего значения.<br>
*Есть у числа, даты, справочника, документа, перечисления и
т.п.</td>
<td><br></td>
</tr>
<tr>
<td>0x15+</td>
<td>дл_вз</td>
<td><br></td>
<td>? Внутренее значение<br></td>
<td><br></td>
</tr>
<tr>
<td><br></td>
<td><br></td>
<td><b>(длина=1+)</b></td>
<td><br></td>
<td><br></td>
</tr>
<tr>
<td>0x00<br></td>
<td>1<br></td>
<td>дл_ф<br></td>
<td><br></td>
<td>0<br></td>
</tr>
<tr>
<td>0x00+</td>
<td>дл_ф</td>
<td><br></td>
<td>Формат</td>
<td><br></td>
</tr>
<tr>
<td><br></td>
<td><br></td>
<td><b>(длина=7+)</b></td>
<td><br></td>
<td><br></td>
</tr>
<tr>
<td>0x00</td>
<td><br></td>
<td>0x01</td>
<td>? (установленно у неопр. значения)<br></td>
<td><br></td>
</tr>
<tr>
<td>0x01</td>
<td><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
</tr>
<tr>
<td>0x02</td>
<td>1<br></td>
<td>0x01<br></td>
<td>Кнопка выбора=1<br></td>
<td>0</td>
</tr>
<tr>
<td>0x03</td>
<td><br></td>
<td><br></td>
<td><br></td>
<td><br></td>
</tr>
<tr>
<td>0x04</td>
<td>1<br></td>
<td>0x01</td>
<td>Сделать недоступным=1<br></td>
<td>0<br></td>
</tr>
<tr>
<td>0x05</td>
<td>1<br></td>
<td>0x01</td>
<td>Запретить редактирование=1<br></td>
<td>0<br></td>
</tr>
<tr>
<td>0x06</td>
<td>1<br></td>
<td>дл_м<br></td>
<td>Длина маски<br></td>
<td><br></td>
</tr>
<tr>
<td>0x06+</td>
<td>дл_м</td>
<td><br></td>
<td>Маска<br></td>
<td><br></td>
</tr>
</tbody>
</table>
<br>
<hr size="2" width="100%">
<h2><a id="PropFont" name="PropFont"></a>Свойства шрифта</h2>
(см. MFC CFont)<br>
<table cellpadding="2" cellspacing="2" border="1">
<tbody>
<tr>
<td><b>Смещение</b></td>
<td><b>Длина</b></td>
<td><b>Знач.</b></td>
<td><b>Комментарий<br></b></td>
<td><b>По умолч.<br></b></td>
</tr>
<tr>
<td>0x00<br></td>
<td>4<br></td>
<td><br></td>
<td>Высота:<br>
0 - По умолчанию<br>
&gt;0 - Размер шрифта<br>
&lt;0 - Абсолютный размер шрифта<br></td>
<td>0<br></td>
</tr>
<tr>
<td>0x04</td>
<td>4<br></td>
<td><br></td>
<td>Ширина<br></td>
<td>0<br></td>
</tr>
<tr>
<td>0x08</td>
<td>4<br></td>
<td><br></td>
<td>Escapement</td>
<td>0<br></td>
</tr>
<tr>
<td>0x0с</td>
<td>4<br></td>
<td><br></td>
<td>Ориентация<br></td>
<td>0<br></td>
</tr>
<tr>
<td>0x10</td>
<td>4<br></td>
<td><br></td>
<td>Weight:<br>
0x700 - bold<br>
0x400 - regular</td>
<td>0<br></td>
</tr>
<tr>
<td>0x14</td>
<td>1<br></td>
<td><br></td>
<td>Italic</td>
<td>0<br></td>
</tr>
<tr>
<td>0x15</td>
<td>1<br></td>
<td><br></td>
<td>Underline</td>
<td>0<br></td>
</tr>
<tr>
<td>0x16</td>
<td>1<br></td>
<td><br></td>
<td>StrikeOut</td>
<td>0<br></td>
</tr>
<tr>
<td>0x17<br></td>
<td>1<br></td>
<td><br></td>
<td>Кодировка:<br>
0xcc (204) - кирилица</td>
<td><br></td>
</tr>
<tr>
<td>0x18</td>
<td>1<br></td>
<td>3<br></td>
<td>OutPrecision:<br>
OUT_STROKE_PRECIS = 3<br></td>
<td><br></td>
</tr>
<tr>
<td>0x19</td>
<td>1<br></td>
<td>2<br></td>
<td>ClipPrecision:<br>
CLIP_STROKE_PRECIS = 2<br></td>
<td><br></td>
</tr>
<tr>
<td>0x1a</td>
<td>1<br></td>
<td>1<br></td>
<td>Quality:<br>
DRAFT_QUALITY = 1<br></td>
<td><br></td>
</tr>
<tr>
<td>0x1b</td>
<td>1<br></td>
<td><br>
<br></td>
<td>PitchAndFamily:<br>
DEFAULT_PITCH = 0<br>
FIXED_PITCH = 1<br>
VARIABLE_PITCH = 2<br>
MONO_FONT = 8<br>
и:<br>
FF_DONTCARE = 0x00<br>
FF_ROMAN = 0x10<br>
FF_SWISS = 0x20<br>
FF_MODERN = 0x30<br>
FF_SCRIPT = 0x40<br>
FF_DECORATIVE = 0x50<br></td>
<td><br></td>
</tr>
<tr>
<td>0x1c</td>
<td>32<br></td>
<td><br></td>
<td>Имя шрифта<br>
(заканчивается на 0)<br></td>
<td><br></td>
</tr>
</tbody>
</table>
<br>
<hr size="2" width="100%">
<h2><a id="Merge" name="Merge"></a>Свойства объединения</h2>
<table cellpadding="2" cellspacing="2" border="1">
<tbody>
<tr>
<td><b>Смещение</b></td>
<td><b>Длина</b></td>
<td><b>Знач.</b></td>
<td><b>Комментарий</b></td>
<td><b>По умолч.<br></b></td>
</tr>
<tr>
<td>0x00</td>
<td>4</td>
<td><br></td>
<td>Номер начальной колонки</td>
<td><br></td>
</tr>
<tr>
<td>0x04</td>
<td>4<br></td>
<td><br></td>
<td>Номер конечной строки</td>
<td><br></td>
</tr>
<tr>
<td>0x08</td>
<td>4</td>
<td><br></td>
<td>Номер конечной колонки</td>
<td><br></td>
</tr>
<tr>
<td>0x0с<br></td>
<td>4<br></td>
<td><br></td>
<td>Номер конечной строки</td>
<td><br></td>
</tr>
</tbody>
</table>
<br>
<hr size="2" width="100%">
<h2><a id="Sect" name="Sect"></a>Свойства секции</h2>
<table border="1" cellspacing="2" cellpadding="2">
<tbody>
<tr>
<td><b>Смещение<br></b></td>
<td><b>Длина<br></b></td>
<td><b>Знач.<br></b></td>
<td><b>Комментарий<br></b></td>
<td><b>По умолч.<br></b></td>
</tr>
<tr>
<td>0x00</td>
<td>4<br></td>
<td><br></td>
<td>Номер начальной строки/колонки<br></td>
<td><br></td>
</tr>
<tr>
<td>0x04</td>
<td>4<br></td>
<td><br></td>
<td>Номер конечной строки/колонки</td>
<td><br></td>
</tr>
<tr>
<td>0x08</td>
<td>4(?)</td>
<td><br></td>
<td>Входимость в другую группу =<br>
номер верхней группы</td>
<td>0<br></td>
</tr>
<tr>
<td>0x0c</td>
<td>1<br></td>
<td>дл</td>
<td>Длина имени секции</td>
<td><br></td>
</tr>
<tr>
<td>+</td>
<td>дл</td>
<td><br></td>
<td>Имя секции</td>
<td><br></td>
</tr>
</tbody>
</table>
<br>
<hr width="100%" size="2">
<h2><a id="Name" name="Name"></a>Свойства имен</h2>
<table cellpadding="2" cellspacing="2" border="1">
<tbody>
<tr>
<td><b>Смещение</b></td>
<td><b>Длина</b></td>
<td><b>Знач.</b></td>
<td><b>Комментарий</b></td>
<td><b>По умолч.</b></td>
</tr>
<tr>
<td>0x00</td>
<td>1<br></td>
<td>дл_и<br></td>
<td>Длина имени<br></td>
<td><br></td>
</tr>
<tr>
<td>0x00+</td>
<td>дл_и</td>
<td><br></td>
<td>Имя</td>
<td><br></td>
</tr>
<tr>
<td>0x00</td>
<td>4(?)</td>
<td>1<br></td>
<td>?<br></td>
<td><br></td>
</tr>
<tr>
<td>0x04<br></td>
<td>4(?)</td>
<td><br></td>
<td>0x0012f9e8 (?)</td>
<td><br></td>
</tr>
<tr>
<td>0x08</td>
<td>4(?)<br></td>
<td>3<br></td>
<td>?<br></td>
<td><br></td>
</tr>
<tr>
<td>0x0c</td>
<td>4<br></td>
<td><br></td>
<td>номер начальной колонки<br></td>
<td><br></td>
</tr>
<tr>
<td>0x10<br></td>
<td>4<br></td>
<td><br></td>
<td>номер начальной строки</td>
<td><br></td>
</tr>
<tr>
<td>0x14</td>
<td>4</td>
<td><br></td>
<td>номер конечной колонки</td>
<td><br></td>
</tr>
<tr>
<td>0x18</td>
<td>4</td>
<td><br></td>
<td>номер конечной строки</td>
<td><br></td>
</tr>
</tbody>
</table>
<hr>
(c) Дмитрий Павлюк<br>
(с) Евгений Пивнев<br>
<br>
</body>
</html>
